import sqlite3
import os

# 常用字詞庫（注音 TAB 詞組 TAB 詞頻）
PHRASES_DATA = """
ㄉㄜ˙	的	99999
ㄧ	一	98000
ㄕˋ	是	97000
ㄅㄨˋ	不	96000
ㄌㄜ˙	了	95000
ㄖㄣˊ	人	94000
ㄨㄛˇ	我	93000
ㄗㄞˋ	在	92000
ㄧㄡˇ	有	91000
ㄊㄚ	他	90000
ㄓㄜˋ	這	89000
ㄨㄟˋ	為	88000
ㄓ	之	87000
ㄉㄚˋ	大	86000
ㄌㄞˊ	來	85000
ㄧˇ	以	84000
ㄍㄜˋ	個	83000
ㄓㄨㄥ	中	82000
ㄕㄤˋ	上	81000
ㄇㄣ˙	們	80000
ㄉㄠˋ	到	79000
ㄕㄨㄛ	說	78000
ㄍㄨㄛˊ	國	77000
ㄏㄜˊ	和	76000
ㄉㄧˋ	地	75000
ㄧㄝˇ	也	74000
ㄗˇ	子	73000
ㄕˊ	時	72000
ㄉㄠˋ	道	71000
ㄔㄨ	出	70000
ㄦˊ	而	69000
ㄧㄠˋ	要	68000
ㄩˊ	於	67000
ㄐㄧㄡˋ	就	66000
ㄒㄧㄚˋ	下	65000
ㄉㄜˊ	得	64000
ㄎㄜˇ	可	63000
ㄋㄧˇ	你	62000
ㄋㄧㄢˊ	年	61000
ㄕㄥ	生	60000
ㄗˋ	自	59000
ㄏㄨㄟˋ	會	58000
ㄋㄚˋ	那	57000
ㄏㄡˋ	後	56000
ㄋㄥˊ	能	55000
ㄉㄨㄟˋ	對	54000
ㄓㄨˇ	主	53000
ㄓㄤˇ	長	52000
ㄕㄣˊ	什	51000
ㄇㄛˊ	麼	50000
ㄕㄣˊ ㄇㄛˊ	什麼	50000
ㄨㄛˇ ㄇㄣ˙	我們	49000
ㄊㄚ ㄇㄣ˙	他們	48000
ㄋㄧˇ ㄇㄣ˙	你們	47000
ㄓㄨㄥ ㄍㄨㄛˊ	中國	46000
ㄊㄞˊ ㄨㄢ	台灣	45500
ㄊㄞˊ ㄅㄟˇ	台北	45000
ㄍㄠ ㄒㄩㄥˊ	高雄	44500
ㄊㄞˊ ㄓㄨㄥ	台中	44000
ㄒㄧㄝˋ ㄒㄧㄝˋ	謝謝	43000
ㄉㄨㄟˋ ㄅㄨˋ ㄑㄧˇ	對不起	42000
ㄇㄟˊ ㄍㄨㄢ ㄒㄧˋ	沒關係	41000
ㄗㄞˋ ㄐㄧㄢˋ	再見	40000
ㄋㄧˇ ㄏㄠˇ	你好	39000
ㄓ ㄉㄠˋ	知道	38000
ㄒㄧˇ ㄏㄨㄢ	喜歡	37000
ㄆㄥˊ ㄧㄡˇ	朋友	36000
ㄍㄨㄥ ㄗㄨㄛˋ	工作	35000
ㄒㄩㄝˊ ㄒㄧㄠˋ	學校	34000
ㄒㄩㄝˊ ㄕㄥ	學生	33000
ㄌㄠˇ ㄕ	老師	32000
ㄐㄧㄚ ㄊㄧㄥˊ	家庭	31000
ㄈㄨˋ ㄇㄨˇ	父母	30000
ㄏㄞˊ ㄗˇ	孩子	29000
ㄉㄧㄢˋ ㄋㄠˇ	電腦	28000
ㄕㄡˇ ㄐㄧ	手機	27000
ㄨㄤˇ ㄌㄨˋ	網路	26000
ㄉㄧㄢˋ ㄧㄥˇ	電影	25000
ㄧㄣ ㄩㄝˋ	音樂	24000
ㄕˊ ㄐㄧㄢ	時間	23000
ㄐㄧㄣ ㄊㄧㄢ	今天	22000
ㄇㄧㄥˊ ㄊㄧㄢ	明天	21000
ㄗㄨㄛˊ ㄊㄧㄢ	昨天	20000
ㄒㄧㄥ ㄑㄧ	星期	19000
ㄩㄝˋ	月	18000
ㄖˋ	日	17000
ㄏㄠˇ	好	95000
ㄏㄣˇ	很	90000
ㄉㄨ	都	88000
ㄓㄣ	真	85000
ㄎㄞ ㄒㄧㄣ	開心	16000
ㄍㄠ ㄒㄧㄥˋ	高興	15500
ㄋㄢˊ ㄍㄨㄛˋ	難過	15000
ㄕㄥ ㄑㄧˋ	生氣	14500
ㄆㄧㄠˋ ㄌㄧㄤˋ	漂亮	14000
ㄎㄜˇ ㄞˋ	可愛	13500
ㄏㄠˇ ㄎㄢˋ	好看	13000
ㄏㄠˇ ㄔ	好吃	12500
ㄏㄠˇ ㄨㄢˊ	好玩	12000
ㄔ ㄈㄢˋ	吃飯	11500
ㄏㄜ ㄕㄨㄟˇ	喝水	11000
ㄕㄨㄟˋ ㄐㄧㄠˋ	睡覺	10500
ㄑㄧˇ ㄔㄨㄤˊ	起床	10000
ㄕㄤˋ ㄅㄢ	上班	9500
ㄒㄧㄚˋ ㄅㄢ	下班	9000
ㄕㄤˋ ㄎㄜˋ	上課	8500
ㄒㄧㄚˋ ㄎㄜˋ	下課	8000
ㄎㄢˋ ㄕㄨ	看書	7500
ㄎㄢˋ ㄉㄧㄢˋ ㄕˋ	看電視	7000
ㄊㄧㄥ ㄧㄣ ㄩㄝˋ	聽音樂	6500
ㄩㄣˋ ㄉㄨㄥˋ	運動	6000
ㄆㄠˇ ㄅㄨˋ	跑步	5500
ㄧㄡˊ ㄧㄥˇ	游泳	5000
ㄉㄚˇ ㄑㄧㄡˊ	打球	4500
ㄌㄩˇ ㄒㄧㄥˊ	旅行	4000
ㄇㄞˇ ㄉㄨㄥ ㄒㄧ	買東西	3500
ㄇㄞˋ	賣	3000
ㄑㄧㄢˊ	錢	2900
ㄉㄨㄛ ㄕㄠˇ	多少	2800
ㄆㄧㄢˊ ㄧˊ	便宜	2700
ㄍㄨㄟˋ	貴	2600
ㄉㄚˋ	大	86000
ㄒㄧㄠˇ	小	85000
ㄍㄠ	高	84000
ㄉㄧ	低	83000
ㄎㄨㄞˋ	快	82000
ㄇㄢˋ	慢	81000
ㄖㄜˋ	熱	80000
ㄌㄥˇ	冷	79000
ㄒㄧㄣ	新	78000
ㄐㄧㄡˋ	舊	77000
ㄉㄨㄥ	東	76000
ㄒㄧ	西	75000
ㄋㄢˊ	南	74000
ㄅㄟˇ	北	73000
ㄓㄨㄥ ㄨˇ	中午	2500
ㄗㄠˇ ㄕㄤˋ	早上	2400
ㄨㄢˇ ㄕㄤˋ	晚上	2300
ㄒㄧㄚˋ ㄨˇ	下午	2200
ㄅㄞˊ ㄊㄧㄢ	白天	2100
ㄧㄝˋ ㄨㄢˇ	夜晚	2000
ㄧ	衣	1900
ㄈㄨˊ	服	1800
ㄧ ㄈㄨˊ	衣服	1850
ㄎㄨˋ ㄗˇ	褲子	1700
ㄒㄧㄝˊ ㄗˇ	鞋子	1600
ㄇㄠˋ ㄗˇ	帽子	1500
ㄅㄠ ㄅㄠ	包包	1400
ㄊㄧㄢ ㄑㄧˋ	天氣	1300
ㄒㄧㄚˋ ㄩˇ	下雨	1200
ㄔㄨ ㄊㄞˋ ㄧㄤˊ	出太陽	1100
ㄩㄣˊ	雲	1000
ㄈㄥ	風	950
ㄒㄩㄝˇ	雪	900
ㄧˊ ㄉㄧㄥˋ	一定	16000
ㄎㄜˇ ㄋㄥˊ	可能	15500
ㄧㄝˇ ㄒㄩˇ	也許	15000
ㄉㄤ ㄖㄢˊ	當然	14500
ㄑㄧˊ ㄕˊ	其實	14000
ㄐㄧ ㄏㄨ	幾乎	13500
ㄈㄟ ㄔㄤˊ	非常	13000
ㄊㄜˋ ㄅㄧㄝˊ	特別	12500
ㄓㄣ ㄉㄜ˙	真的	12000
ㄐㄧㄚˇ ㄉㄜ˙	假的	11500
ㄒㄧㄤˇ	想	88000
ㄓ ㄉㄠˋ	知道	38000
ㄧˇ ㄨㄟˊ	以為	11000
ㄐㄩㄝˊ ㄉㄜˊ	覺得	10500
ㄖㄣˋ ㄨㄟˊ	認為	10000
ㄒㄧㄤ ㄒㄧㄣˋ	相信	9500
ㄏㄨㄞˊ ㄧˊ	懷疑	9000
ㄊㄨㄥˊ ㄧˋ	同意	8500
ㄈㄢˇ ㄉㄨㄟˋ	反對	8000
ㄓ ㄔˊ	支持	7500
ㄅㄤ ㄇㄤˊ	幫忙	7000
ㄅㄤ ㄓㄨˋ	幫助	6500
ㄍㄢˇ ㄒㄧㄝˋ	感謝	6000
ㄅㄠˋ ㄑㄧㄢˋ	抱歉	5500
ㄑㄧㄥˇ ㄨㄣˋ	請問	5000
ㄇㄟˊ ㄧㄡˇ	沒有	85000
ㄅㄨˊ ㄕˋ	不是	84000
ㄅㄨˊ ㄒㄧㄥˊ	不行	4500
ㄎㄜˇ ㄧˇ	可以	80000
ㄇㄟˊ ㄨㄣˋ ㄊㄧˊ	沒問題	4000
ㄅㄨˊ ㄎㄜˋ ㄑㄧˋ	不客氣	3500
ㄅㄨˊ ㄏㄠˇ ㄧˋ ㄙ	不好意思	3000
ㄉㄨㄟˋ ㄅㄨˋ ㄑㄧˇ	對不起	42000
ㄇㄟˊ ㄍㄨㄢ ㄒㄧˋ	沒關係	41000
"""

# 常用單字（高頻率單字補充）
SINGLE_CHARS = """
ㄚ	啊阿	50000
ㄞˋ	愛礙	49000
ㄢ	安	48000
ㄤ	骯	5000
ㄠ	凹	5000
ㄅㄚ	八巴把爸吧	47000
ㄅㄞˊ	白	46000
ㄅㄢˋ	半辦伴扮	45000
ㄅㄤ	幫邦	44000
ㄅㄠˇ	寶保飽	43000
ㄅㄟˋ	被背備倍輩	42000
ㄅㄣˇ	本	41000
ㄅㄧˇ	比筆彼	40000
ㄅㄧㄢ	邊編	39000
ㄅㄧㄝˊ	別	38000
ㄅㄧㄥˋ	病並	37000
ㄅㄨˋ	不部步布	96000
ㄘㄞˊ	才財材裁	36000
ㄘㄤˊ	藏	35000
ㄔㄚˋ	差查	34000
ㄔㄤˊ	長常場	33000
ㄔㄠ	超抄	32000
ㄔㄜ	車	31000
ㄔㄥˊ	成城程	30000
ㄔ	吃	29000
ㄔㄨ	出初	28000
ㄔㄨㄢˊ	傳船	27000
ㄔㄨㄣ	春	26000
ㄘˇ	此次	25000
ㄘㄨㄥˊ	從	24000
ㄉㄚˊ	答達打大	86000
ㄉㄞˋ	代帶待戴袋	23000
ㄉㄢ	單擔但蛋淡	22000
ㄉㄠˋ	道到倒導	21000
ㄉㄜˊ	得德	20000
ㄉㄥˇ	等燈	19000
ㄉㄧˇ	底低敵地第弟	18000
ㄉㄧㄢˇ	點店典電	17000
ㄉㄧㄠˋ	掉調	16000
ㄉㄧㄥˋ	定訂頂	15000
ㄉㄨㄥ	東冬懂動	14000
ㄉㄡ	都豆讀鬥	13000
ㄉㄨˋ	度讀渡	12000
ㄉㄨㄢˋ	斷段	11000
ㄉㄨㄟˋ	對隊	10000
ㄉㄨㄛ	多	9000
ㄜˋ	惡餓	8000
ㄦˊ	而兒	7000
ㄈㄚˇ	法髮發	6000
ㄈㄢˋ	飯犯範反	5500
ㄈㄤ	方放房	5000
ㄈㄟ	非飛	4500
ㄈㄣ	分份	4000
ㄈㄥ	風封瘋	3500
ㄈㄨˊ	服福扶夫府父	3000
ㄍㄞ	該改蓋	2500
ㄍㄢˇ	敢感趕	2000
ㄍㄤ	剛港鋼	1500
ㄍㄠ	高搞告	1000
ㄍㄜ	哥歌個各格	95000
ㄍㄟˇ	給	90000
ㄍㄣ	跟根	85000
ㄍㄥˋ	更	80000
ㄍㄨㄥ	工公功共宮弓	75000
ㄍㄡˇ	狗夠構購	70000
ㄍㄨˇ	古故鼓股谷骨	65000
ㄍㄨㄚ	瓜掛刮	60000
ㄍㄨㄞˋ	怪	55000
ㄍㄨㄢ	關管館觀官	50000
ㄍㄨㄤ	光廣	45000
ㄍㄨㄟˋ	貴跪鬼	40000
ㄍㄨㄛˊ	國過果	35000
ㄏㄞˊ	還海孩害	30000
ㄏㄢˋ	漢汗	25000
ㄏㄤˊ	行航	20000
ㄏㄠˇ	好號	95000
ㄏㄜˊ	和合河何	76000
ㄏㄟ	黑嘿	15000
ㄏㄣˇ	很狠	90000
ㄏㄨㄥˊ	紅	10000
ㄏㄡˋ	後候厚	5000
ㄏㄨ	呼湖乎忽	4500
ㄏㄨㄚ	花化話畫華	4000
ㄏㄨㄞˋ	壞懷	3500
ㄏㄨㄢ	歡環還換	3000
ㄏㄨㄤˊ	黃皇	2500
ㄏㄨㄟˊ	回會	2000
ㄏㄨㄣ	婚混魂	1500
ㄏㄨㄛˇ	火活	1000
ㄐㄧ	機基雞及極	95000
ㄐㄧˇ	幾己擠	90000
ㄐㄧˋ	記計繼技季	85000
ㄐㄧㄚ	家加假價嫁架	80000
ㄐㄧㄢˇ	簡減檢建	75000
ㄐㄧㄤ	將江講獎	70000
ㄐㄧㄠ	交教叫角腳較	65000
ㄐㄧㄝ	接街結界借	60000
ㄐㄧㄣ	今金近緊進	55000
ㄐㄧㄥ	精經京驚景靜	50000
ㄐㄧㄡˇ	九久酒舊就	45000
ㄐㄩˇ	舉句具	40000
ㄐㄩㄝˊ	決絕覺角	35000
ㄎㄞ	開	30000
ㄎㄢˋ	看	25000
ㄎㄜˇ	可課刻克客科	63000
ㄎㄨㄥˇ	恐空孔控	20000
ㄎㄡˇ	口	15000
ㄎㄨ	哭苦庫	10000
ㄎㄨㄞˋ	快塊	82000
ㄎㄨㄤˊ	狂況	5000
ㄌㄞˊ	來	85000
ㄌㄠˇ	老勞	4500
ㄌㄜˋ	樂了	4000
ㄌㄟˇ	累類淚	3500
ㄌㄧˇ	理禮里李裡	3000
ㄌㄧˋ	力利立例歷	2500
ㄌㄧㄢˊ	連聯臉練	2000
ㄌㄧㄤˊ	良量涼	1500
ㄌㄧㄠˇ	了	95000
ㄌㄧㄝˋ	列烈	1000
ㄌㄧㄣˊ	林	950
ㄌㄧㄥˊ	零靈另令領	900
ㄌㄧㄡˊ	留流六	850
ㄌㄨˋ	路錄露綠	800
ㄇㄚ	媽嗎馬罵麻	90000
ㄇㄞˇ	買賣	85000
ㄇㄢˇ	滿慢	80000
ㄇㄤˊ	忙茫盲	75000
ㄇㄠ	貓毛	70000
ㄇㄟˊ	沒美每梅	65000
ㄇㄣˊ	門們	60000
ㄇㄧˋ	密秘蜜	55000
ㄇㄧㄢˋ	面免棉	50000
ㄇㄧㄥˊ	明名命	45000
ㄇㄨˋ	目木母	40000
ㄋㄚˇ	哪那拿	35000
ㄋㄞˇ	奶乃	30000
ㄋㄢˊ	男南難	74000
ㄋㄠˇ	腦惱	25000
ㄋㄟˋ	內那	20000
ㄋㄥˊ	能	55000
ㄋㄧˇ	你妳	62000
ㄋㄧㄢˊ	年念	61000
ㄋㄧㄤˊ	娘	15000
ㄋㄧㄡˊ	牛	10000
ㄋㄩˇ	女	5000
ㄆㄚˋ	怕拍爬	4500
ㄆㄞˊ	排牌	4000
ㄆㄤˊ	旁胖	3500
ㄆㄠˇ	跑炮泡	3000
ㄆㄥˊ	朋棚	2500
ㄆㄧˊ	皮批疲	2000
ㄆㄧㄢˋ	片騙偏篇	1500
ㄆㄧㄥˊ	平評瓶蘋	1000
ㄆㄛˋ	破婆	950
ㄑㄧ	七期其妻棋	900
ㄑㄧˊ	奇騎旗齊	850
ㄑㄧˋ	氣器起棄	800
ㄑㄧㄢˊ	前錢	90000
ㄑㄧㄤˊ	強牆	750
ㄑㄧㄠˇ	巧	700
ㄑㄧㄝˋ	切且	650
ㄑㄧㄣ	親琴勤	600
ㄑㄧㄥ	輕清情請青	550
ㄑㄧㄡ	球秋求	500
ㄑㄩˋ	去取趣	95000
ㄑㄩㄢˊ	全權泉	450
ㄑㄩㄝ	缺確卻	400
ㄖㄢˊ	然燃	350
ㄖㄤˋ	讓	300
ㄖㄜˋ	熱	80000
ㄖㄣˊ	人認	94000
ㄖˋ	日	17000
ㄖㄨˊ	如入	250
ㄙㄢ	三散傘	200
ㄙㄜˋ	色	150
ㄕㄚ	殺沙	100
ㄕㄢ	山閃善	95
ㄕㄤˋ	上商傷	81000
ㄕㄠˇ	少紹燒	90
ㄕㄜˋ	社設射	85
ㄕㄟˊ	誰	80
ㄕㄣ	身深神	75
ㄕㄥ	生聲升勝	60000
ㄕ	師詩十石失時	70
ㄕˋ	是事視市式世	97000
ㄕㄡˇ	手首守收	65
ㄕㄨ	書輸	60
ㄕㄨˇ	數屬鼠樹	55
ㄕㄨㄛ	說	78000
ㄙ	思司私	50
ㄙˇ	死四似	45
ㄙㄨㄥˋ	送鬆	40
ㄙㄨˋ	素速俗宿	35
ㄙㄨㄢˋ	算蒜酸	30
ㄙㄨㄟ	雖隨碎	25
ㄙㄨㄣ	孫損	20
ㄙㄨㄛˇ	所縮鎖	15
ㄊㄚ	他她它塔踏	90000
ㄊㄞˋ	太態泰	10
ㄊㄢˊ	談彈壇	5
ㄊㄤˊ	糖堂唐	4
ㄊㄠˊ	逃桃	3
ㄊㄜˋ	特	2
ㄊㄧˊ	題提	1
ㄊㄧㄢ	天添田甜	95000
ㄊㄧㄠˊ	條調跳	90000
ㄊㄧㄥ	聽停廳庭	85000
ㄊㄨㄥˊ	同童痛通	80000
ㄊㄡˊ	頭偷投透	75000
ㄊㄨˊ	圖土突	70000
ㄊㄨㄟ	推腿退	65000
ㄨㄞˋ	外	60000
ㄨㄢˊ	完玩	55000
ㄨㄤˊ	王網忘望往	50000
ㄨㄟˊ	為圍微危	88000
ㄨㄣˊ	文聞問溫	45000
ㄨㄛˇ	我	93000
ㄨˇ	五午武舞	40000
ㄨˋ	物務霧誤	35000
ㄒㄧ	西息希吸惜洗系細	75000
ㄒㄧㄚˋ	下夏嚇	65000
ㄒㄧㄢ	先仙鮮線現限	95000
ㄒㄧㄤ	想香相向箱象像	90000
ㄒㄧㄠˇ	小笑消曉	85000
ㄒㄧㄝˇ	寫謝些血	80000
ㄒㄧㄣ	心信新星興	78000
ㄒㄧㄥˊ	行形型醒性姓	75000
ㄒㄩ	需須許虛	70000
ㄒㄩㄢˇ	選	65000
ㄒㄩㄝˊ	學	34000
ㄧㄚ	呀押鴨	60000
ㄧㄢˊ	言研眼嚴鹽顏	55000
ㄧㄤˊ	羊陽洋樣養	50000
ㄧㄠˋ	要藥邀搖	68000
ㄧㄝˋ	也業夜葉頁	74000
ㄧ	一衣依醫	98000
ㄧˇ	以已椅	84000
ㄧˋ	意義易益	45000
ㄧㄣ	因音陰	40000
ㄧㄥ	英應影迎營	35000
ㄩㄥˇ	永用勇泳	30000
ㄧㄡˇ	有友又油右	91000
ㄩˊ	於魚雨語	67000
ㄩㄢˊ	元原園員遠院圓源願	25000
ㄩㄝˋ	月越約樂	18000
ㄩㄣˊ	雲運	20000
ㄗㄞˋ	在再	92000
ㄗㄠˇ	早造	15000
ㄗㄜˊ	則責擇	10000
ㄗㄣˇ	怎	5000
ㄓㄚˋ	炸詐	4500
ㄓㄢˋ	站戰	4000
ㄓㄤ	張章長漲丈掌	52000
ㄓㄠˇ	找照	3500
ㄓㄜˋ	這著	89000
ㄓㄣ	真針陣鎮	85000
ㄓㄥˋ	正整政證	3000
ㄓ	之知支只直值	87000
ㄓˇ	只指止紙	2500
ㄓˋ	至制治質志置致	2000
ㄓㄨㄥ	中終鐘種重	82000
ㄓㄡ	周洲舟州	1500
ㄓㄨˇ	主住注煮	53000
ㄓㄨㄢˇ	轉專	1000
ㄓㄨㄤˋ	狀裝撞	950
ㄓㄨㄟ	追	900
ㄗˇ	子字自	73000
ㄗㄨˇ	組祖	850
ㄗㄨㄟˋ	最罪嘴醉	800
ㄗㄨㄛˋ	作做坐座昨	750
"""

def create_database(db_path):
    """建立詞庫資料庫"""
    
    # 確保目錄存在
    os.makedirs(os.path.dirname(db_path), exist_ok=True)
    
    # 刪除舊資料庫
    if os.path.exists(db_path):
        os.remove(db_path)
    
    conn = sqlite3.connect(db_path)
    cursor = conn.cursor()
    
    # 建立表格
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS phrases (
            id INTEGER PRIMARY KEY AUTOINCREMENT,
            zhuyin TEXT NOT NULL,
            phrase TEXT NOT NULL,
            frequency INTEGER DEFAULT 100,
            length INTEGER,
            UNIQUE(zhuyin, phrase)
        )
    ''')
    
    # 建立索引
    cursor.execute('CREATE INDEX IF NOT EXISTS idx_zhuyin ON phrases(zhuyin)')
    cursor.execute('CREATE INDEX IF NOT EXISTS idx_freq ON phrases(frequency DESC)')
    cursor.execute('CREATE INDEX IF NOT EXISTS idx_length ON phrases(length)')
    
    # 匯入詞組
    count = 0
    for line in PHRASES_DATA.strip().split('\n'):
        line = line.strip()
        if not line:
            continue
        
        parts = line.split('\t')
        if len(parts) >= 2:
            zhuyin = parts[0].strip()
            phrase = parts[1].strip()
            frequency = int(parts[2]) if len(parts) > 2 else 100
            
            try:
                cursor.execute('''
                    INSERT OR IGNORE INTO phrases (zhuyin, phrase, frequency, length)
                    VALUES (?, ?, ?, ?)
                ''', (zhuyin, phrase, frequency, len(phrase)))
                count += 1
            except:
                pass
    
    # 匯入單字
    for line in SINGLE_CHARS.strip().split('\n'):
        line = line.strip()
        if not line:
            continue
        
        parts = line.split('\t')
        if len(parts) >= 2:
            zhuyin = parts[0].strip()
            chars = parts[1].strip()
            frequency = int(parts[2]) if len(parts) > 2 else 100
            
            # 每個字分開處理
            for i, char in enumerate(chars):
                try:
                    # 頻率遞減
                    freq = max(1, frequency - i * 1000)
                    cursor.execute('''
                        INSERT OR IGNORE INTO phrases (zhuyin, phrase, frequency, length)
                        VALUES (?, ?, ?, 1)
                    ''', (zhuyin, char, freq))
                    count += 1
                except:
                    pass
    
    conn.commit()
    
    # 統計
    cursor.execute('SELECT COUNT(*) FROM phrases')
    total = cursor.fetchone()[0]
    
    cursor.execute('SELECT COUNT(*) FROM phrases WHERE length = 1')
    chars = cursor.fetchone()[0]
    
    cursor.execute('SELECT COUNT(*) FROM phrases WHERE length > 1')
    words = cursor.fetchone()[0]
    
    conn.close()
    
    print(f"詞庫建立完成: {db_path}")
    print(f"總數: {total}, 單字: {chars}, 詞組: {words}")
    
    return total


if __name__ == '__main__':
    import sys
    
    if len(sys.argv) > 1:
        db_path = sys.argv[1]
    else:
        db_path = 'phrases.db'
    
    create_database(db_path)
